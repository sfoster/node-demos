<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebSocket Demo</title>
  <style>
    table {
      background-color: #eee;
    }
    td, th {
      border: 1px solid #fff;
      text-align: right; 
      padding: 3px 10px;
    }
  </style>
</head>
<body>
  <h1>WebSocket Demo</h1>

  <table>
    <thead>
      <th>RSS (MB)</th>
      <th>heapTotal (MB)</th>
      <th>heapUsed (MB)</th>
    </thead>
    <tbody id="output">
      <tr>
        <td colspan="3" style="text-align: center; font-style: italic">No data</td>
      </tr>
    </tbody>
  </table>

  <script>
  console.log("opening websocket connection to: " + 'ws://'+ location.hostname +':8080');
  var ws = new WebSocket('ws://localhost:8080');
  // var ws = new WebSocket('ws://'+ location.hostname +':8080');
  ws.onmessage = function(evt){
    console.log("Web socket message: ", evt.data, evt);
  };
  ws.onopen = function(){
    // Web Socket is connected, send data using send()
    ws.send(JSON.stringify({
      msg: navigator.userAgent
    }));
  };
  
  function hangup(){
    ws.onclose = function () {}; // disable onclose handler first
    ws.close();
  }
  window.onbeforeunload = hangup;
  </script>
</body>
</html>
